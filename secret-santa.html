<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santa Sekret 🎅</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            font-family: Arial, sans-serif;
        }
        .container {
            margin-top: 50px;
        }
        .card {
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card p-4">
            <h2 class="text-center">Santa Sekret 🎅</h2>
            <div id="inputSection" class="text-center">
                <p class="lead">Vendos emrin tënd për të zbuluar dhuratën që ke për të blerë.</p>
                <input type="text" id="nameInput" class="form-control mb-3" placeholder="Vendos emrin tënd" />
                <button id="revealButton" class="btn btn-primary">Zbulo Dhuratën</button>
            </div>
            <div id="resultSection" class="mt-4 text-center" style="display: none;">
                <h4 id="assignmentResult" class="text-success"></h4>
                <p class="text-muted">Rezultati juaj është ruajtur në localStorage. Nuk mund ta shihni më!</p>
            </div>
        </div>
    </div>

    <script>
        // Assignments encoded with a simple cipher (shifted letters/numbers)
        const encodedAssignments = {
            A1: "Grfu qlq C3, J10, K11",
            B2: "Grfu qlq E5, I9",
            C3: "Grfu qlq F6, H8",
            D4: "Grfu qlq G7, L12",
            E5: "Grfu qlq B2, J10",
            F6: "Grfu qlq A1, K11",
            G7: "Grfu qlq D4, L12",
            H8: "Grfu qlq I9",
            I9: "Grfu qlq H8"
        };

        // A simple cipher decoder (shifts letters back by 3 characters)
        function decodeMessage(encoded) {
            return encoded.split('').map(char => {
                const code = char.charCodeAt(0);
                // If the character is a letter (A-Z or a-z), shift it back by 3 characters
                if ((code >= 65 && code <= 90) || (code >= 97 && code <= 122)) {
                    return String.fromCharCode(code - 3);
                }
                return char; // Non-alphabet characters are not modified
            }).join('');
        }

        document.getElementById("revealButton").addEventListener("click", function () {
            const name = document.getElementById("nameInput").value.trim();
            if (!name) {
                alert("Ju lutem, vendosni emrin tuaj.");
                return;
            }

            // Check if the name exists in the codebook (you can manually verify the list below)
            const names = ["Mentor", "Mami", "Dita", "Armend", "Fatime", "Dona", "Dexa", "Oli", "Etna", "Dielli", "Vera", "Beni"];
            if (!names.includes(name)) {
                alert("Emri juaj nuk është i njohur në këtë lojë Santa Sekret.");
                return;
            }

            // Check if already retrieved
            const localStorageKey = "secretSantaBanesa3";
            const usedNames = JSON.parse(localStorage.getItem(localStorageKey)) || [];
            if (usedNames.includes(name)) {
                alert("Ju tashmë keni parë rezultatin tuaj!");
                return;
            }

            // Store name in localStorage
            usedNames.push(name);
            localStorage.setItem(localStorageKey, JSON.stringify(usedNames));

            // Get the assignment code for the person
            let code = "";
            switch(name) {
                case "Mentor":
                    code = "A1";
                    break;
                case "Mami":
                    code = "B2";
                    break;
                case "Dita":
                    code = "C3";
                    break;
                case "Armend":
                    code = "D4";
                    break;
                case "Fatime":
                    code = "E5";
                    break;
                case "Dona":
                    code = "F6";
                    break;
                case "Dexa":
                    code = "G7";
                    break;
                case "Oli":
                    code = "H8";
                    break;
                case "Etna":
                    code = "I9";
                    break;
                case "Dielli":
                    code = "J10";
                    break;
                case "Vera":
                    code = "K11";
                    break;
                case "Beni":
                    code = "L12";
                    break;
            }

            // Get the encoded assignment and decode it
            const assignment = decodeMessage(encodedAssignments[code]);

            // Display the decoded assignment
            document.getElementById("assignmentResult").innerText = assignment;
            document.getElementById("inputSection").style.display = "none";
            document.getElementById("resultSection").style.display = "block";
        });
    </script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
